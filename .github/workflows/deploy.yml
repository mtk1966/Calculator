name: Sunucuya Deploy Et

on:
  push:
    branches: [ "main" ]

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - name: Sunucuya BaÄŸlan ve GÃ¼ncelle
        uses: appleboy/ssh-action@v1.0.0
        with:
          host: ${{ secrets.HOST }}
          username: ${{ secrets.USERNAME }}
          password: ${{ secrets.PASSWORD }}
          port: 22
          script: |
            # Hata olursa iÅŸlemi durdur
            set -e
            
            echo "ðŸš€ Åžifre ile GÃ¼ncelleme BaÅŸlÄ±yor..."

            # 1. Proje KlasÃ¶rÃ¼ne Git
            cd /home/Projects/Calculator

            # 2. KodlarÄ± Ã‡ek
            git pull origin main

            # 3. Web Projesi KlasÃ¶rÃ¼ne Gir
            cd Calculator.Web

            # 4. Derle
            dotnet publish -c Release -o /opt/calculator

            # 5. Servisi Yeniden BaÅŸlat
            systemctl restart calculator

            echo "âœ… Ä°ÅŸlem TamamlandÄ±!"
